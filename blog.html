<!doctype html>
<html>
  <title>Blog</title>
  <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
  <script>
    function defer(func, str) {
      if (!eval(str)) {
        setTimeout(function() {defer(func, str)}, 4);
      } else func();
    }
    
    var done = false;
    $.get('details', function(data) {
      var post = JSON.parse(data);
      $('body').html('<hr><h1>'+post.title+'</h1><div class="post"><article url="'+post.url+'"></article></div>'+$('body').html());
      done = true;
    });
    
    defer(
      function() {
        $('body').html($('body').html()+'<hr>');
        var articles = $('article');
        for (var i=0; i<articles.length; i++) {
          
          $.get(articles.eq(i).attr('url'), eval(`function(data) {
            console.log(articles.eq(i).attr('url'));
            console.log(data);
            articles.eq(`+i+`).html(data);
          }`);
        }
      },
    'done');
  </script>
  <body>
  </body>
</html>
